# Technical Design Record — LMS

> Документ фиксирует ключевые решения по проекту.
> Заполни каждый раздел: пустые места помечены `[ TODO ]`.

---

## 1. Обзор проекта

### 1.1 Название и суть
**Название:** [ TODO — рабочее название системы ]

**Одна фраза о продукте:** [ система обучения сотрудников ]

### 1.2 Проблема, которую решает
[ малый бизнес которому нужно обучать низко квалифицированных сотрудников]

### 1.3 Целевая аудитория
Малый предприниматель которому нужно регулярно учить работников.
НАпример: Человек открыл чайную и набирает продавцов. Срок жизни продавца примерно 6-12 месяцев и каждый раз учить новых людей достаточно сложно

---

## 2. Роли и права доступа
1. Админ - обеспечивает права и доступы, может создавать курсы и материалы.
2. Создатель курсов - создаёт курсы. Это "надстройка" над ролью, по умолчанию есть у админа, может быть назначена на работника.
3. Работник/обучающийся - проходит курсы и изучает материалы

---

## 3. Функциональные требования

### 3.1 Обязательный MVP (должно работать в первой версии)
- Админ может управлять пользователями: создание, приглашение, редактирование, удаление, увольнение + то что может создатель курсов
- Создатель курсов может создавать курсы, загружать обучающие материалы, назначать курсы на обучающихся
- Работник/обучающийся может заходить, просматривать курсы и обучающие материалы
! "Работник" - это скорее юзер портал, тк назначить курс можно всем и каждому 

??? для Даниила: мб по мобиле регистрацию и вход? такого даже у айспринга нет)

### 3.2 Желательно (второй приоритет)
- Разбить пользователей по группам/отделам чтобы назначать нужные курсы на сотрудников нужных отделов/профессий

### 3.3 За рамками MVP (не делаем сейчас)
- Пока не знаем

---

## 4. Сценарии использования (User Flows)

> Админ создаёт пользователя: Админ вводит ФИО - Админ вводит почту - на почту приходит письмо со ссылкой на саморегистрацию
> Админ создаёт ползователя без почты: Админ вводит ФИО - Админ отдаёт ссылку на саморегистрацию 
> Работник  регистрируется: Работник получает ссылку по почте или лично - работник придумывает свой логин и пароль - работник входит в систему
> Админ назначает работника создателем курсов: Админ заходит в список пользователей - Админ выбирает пользователя - Админ даёт ему права создателя курсов
> Создатель курсов создаёт курс: В списке курсов создаёт новый курс - даёт ему название - складывает внутрб курса материалы - составляет порядок прохождения - при необходимости назначает курс пользователям - завершает создание курса
> Работник проходит курс: Работник получает уведомление что ему пришел курс - работник выбирает курс - работник изучает материал курса - работник завершает прохождение курса

---

## 5. Контент и структура обучения

### 5.1 Из чего состоит курс
Курс → Список заданий (плоская структура, без вложенных разделов).
Внутри курса можно прикреплять файлы.
У курса есть название и список людей с тремя статусами: назначен / в процессе / прошёл.

### 5.2 Типы контента
Видео и прикреплённые файлы. Видео скачивается файлом — встроенного проигрывателя нет на MVP.

### 5.3 Проверка знаний
Тестов нет. Прохождение курса фиксируется вручную: работник нажимает кнопку "Завершить курс".
В будущем: отслеживание прогресса по отдельным материалам.

---

## 6. Монетизация

Подписка 500 рублей в месяц за всю компанию (не за каждого пользователя).
Платит владелец/администратор компании-аккаунта.

---

## 7. Интеграции

| Сервис | Назначение | Критичность |
|--------|-----------|-------------|
| ЮКасса | Приём оплаты подписки | MVP |
| Timeweb Object Storage | Хранение файлов и видео | MVP |
| SMTP (уточнить) | Отправка инвайт-ссылок на почту | MVP |

---

## 8. Нефункциональные требования
Целевое время простоя: менее 3 часов в год (99.97% uptime).

### 8.1 Масштаб
MVP: 10 компаний-аккаунтов, в каждой до 10 человек.
Компании полностью изолированы друг от друга (мультитенантность).
Пользователь принадлежит ровно одной компании.

### 8.2 Производительность
Требований к скорости не зафиксировано.

### 8.3 Доступность и устройства
Веб-версия с адаптивом под мобильные браузеры. Нативных приложений нет.

### 8.4 Локализация
Только русский язык. СНГ — позже.
---

## 9. Технический стек

| Слой | Технология | Причина выбора |
|------|-----------|----------------|
| Frontend + Backend | Next.js (App Router, Node.js режим) | Один проект, один язык, лучшая поддержка AI-генерации кода |
| Язык | TypeScript | Типизация снижает количество ошибок в AI-генерируемом коде |
| ORM + миграции | Prisma | Типы из схемы, миграции одной командой |
| База данных | PostgreSQL | На том же сервере Timeweb |
| Файловое хранилище | Timeweb Object Storage (S3-совместимый) | Один провайдер, данные в России, нет ограничений на размер файлов |
| Хостинг | Timeweb VPS (уже есть) | Сервер уже оплачен, российский датацентр — низкая задержка |
| Процесс-менеджер | PM2 + Nginx | Стандарт для Node.js на VPS |
| Аутентификация | Auth.js (NextAuth) | Нативная интеграция с Next.js, поддержка кастомных токенов для инвайт-ссылок |
| Платёжка | ЮКасса | Стандарт для РФ, есть готовые SDK |

---

## 10. Команда и ограничения

я и мои друзья

---

## 11. Открытые вопросы

> Вещи, которые ещё не решены и требуют ответа перед началом разработки.

- Какой платёжный провайдер? (ЮKassa, Тинькофф, другой?)
- Ссылка на регистрацию — уникальная на каждого пользователя, действует 24 часа.
  Открытый вопрос: нужна ли ссылка-приглашение для всей компании (любой по ней регистрируется)?
- Уведомления о назначении курса — только in-app. Email-уведомления за рамками MVP.
- Уволенный работник: теряет доступ, скрывается в интерфейсе, данные о прохождении курсов сохраняются.

